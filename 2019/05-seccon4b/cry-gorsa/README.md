# SECCON Beginners CTF 2019 "Go RSA" [Crypto]

## 問題
Nだけなくしちゃったんだよなあ……。

Server: nc 133.242.17.175 1337

## 解法

問題名からRSAだと仮定する。c ( `=pow(flag, e, n)` ) と d が与えられている。また、整数mを送るとpow(m, e, n)が返ってくる。これを3回まで繰り返す事ができる。eは不明だが多分65537と当たりをつけた。

m1、m2を送ったとき返ってくる値はそれぞれ `m1**e+k1*n`, `m2**e+k2*n` と書けるので、`m1**e`, `m2**e` からそれぞれ引くと

`m1**e - (m1**e+k1*n) = k1*n`
`m2**e - (m2**e+k2*n) = k2*n`

となる。k1,k2が公約数を持たなければ、これら2つの値のGCDはnになっている（はず）。
`m**e`は大きくなるので適当に2, 3あたりを選んだ。
これでとりあえず復号してみたら正解だった。

```python
from math import gcd
from ctflib import *
c = 6942548342581263810547846517231748514753354612072004295894707659186392493742383379930566955978307235518160474184488219436316498076251558683124097408738924664933705180779403677926699581609823207078651866175103937494325676173583444960678878980222937921474744158789811254393736539595097031488418131547690343378324207162230289212686920240768911203234724403002727853659811089030603235860134211615828219156206652285253963240150039624634908539780516044836507061382413138028635430837145136200676182869853773687616870327164289992248089310821364720942965820108515713263460333168615081753874383148848615362741518650262947060572

c1 = 12412577859391026595360852958859494035047269621143861662580292624328701129507568089117616263898412894713478903728505694256331209079622376639036683494945581206322705987143462894706980456636883853626029788002097486724486527681480654487010991920733323889469717448993702726657023388795260508646160223235393144246371264488268317726526647239029070956301115525287822695421178782923551134928456168435826128384728242003875619031704652094802892807719108715373024533248419704978883541074082143554249900138467427609121909228217435738597842852418649595855316339519065667683458750513258398434776417950857997706991598237129100990975

c2 = 14923729145583129956001371306413243620405355101648087058277184406964680178487091077946091969174092386605785883865799373442860587041262476634558638541781107931176302079805545147623164926313457774161650788172007382342994265312418831351241657490143867429647835998190451396211560069546129162838706985343038892602037617832040604673401964668083528100116694019013333112153550143280762093529273469592266837368737052470748082777743331989899820064866236275517516267551251155598725783064696625968153987108367808749470011504131626139324489646349583350050601222249312875455669746258728337578176885302522009628739126661419062146454


a1 = pow(2, 65537) - c1
a2 = pow(3, 65537) - c2

n = gcd(a1, a2)

d = 1315412508642041718899316956523813648660368828325415276275421128956776727390290079424792654680775917908448240329851094893486278129005838008935833313552526647919821371849600091494949680961273235411643239701887619304087557181250207711058739395960146287342398971406762178309001191001904756378196993717502579230318899831513700854367770220139333435606342513624815446979469300369336122871209824274075026092874085887941635388999757712610428313206244502978464151400250772398420499588270561384332770033040251173474387692550679930214429511834251946218736971333158236459925978108818222162491694007558080698563773138356949193517

print(its(pow(c, d, n)))
```


Flag: `ctf4b{f1nd_7he_p4ramet3rs}`
